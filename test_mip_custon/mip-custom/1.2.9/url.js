define("mip-custom/url",["require","util","viewer","mip-custom/dom","mip-custom/data"],function(t){function e(){var t=p.params;for(var e in t)if(t.hasOwnProperty(e))t[e]=p.getHashData(e)||t[e];t.logid=p.getHashData("lid"),t.eqid=p.getHashData("eqid");for(var i=["originalSource","mediaid","fn"],n=0;n<i.length;n++){var o=i[n];if(p.getHashData(o))t[o]=p.getHashData(o)}return t}function i(t){var e=null;try{var i=l.getConfigScriptElement(t);if(i){if(e=JSON.parse(i.textContent),!e.accid)return void console.warn("mip-custom 缺少 accid 参数");if(!e.title)return void console.warn("mip-custom 缺少 title 参数");for(var n in e)if(e.hasOwnProperty(n))e[n]=decodeURIComponent(e[n])}}catch(t){return console.warn("json is illegal"),void console.warn(t)}return e}function n(t){var n=i(t);if(!n)return null;else return c.fn.extend(e(),n)}function o(t,e){var i=!0,o="top"===e?p.topAjaxUrl:p.ajaxUrl,c=n(t);if(c){for(var s in c){if(c.hasOwnProperty(s))o+=(!i?"&":"")+s+"="+c[s],i=!1;console.log("this url ="+o)}if("top"===e){var l=r();if(l)o+="&sourceId="+encodeURIComponent(l)}if(!a(t))o+="&from=noshell";return o}}function r(){var t=document.querySelectorAll("mip-custom[position=top]"),e=[],i=t.length;if(t&&i>0)for(var n=0;n<i;n++){var o=t[n],r=o&&o.getAttribute("source-type");r&&e.push(r)}return e.join(",")}function a(t){var e=!0;if(!s.isIframed)e=!1;if(!p.regexs.domain.test(window.document.referrer)&&!c.fn.isCacheUrl(location.href))e=!1;return e}var c=t("util"),s=t("viewer"),l=t("mip-custom/dom"),p=t("mip-custom/data");return{get:o}});